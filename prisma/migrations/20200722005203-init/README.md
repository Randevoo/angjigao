# Migration `20200722005203-init`

This migration has been generated by winsonhys at 7/22/2020, 12:52:03 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User" (
"id" text  NOT NULL ,
"email" text  NOT NULL ,
"username" text  NOT NULL ,
"password" text  NOT NULL ,
"dob" timestamp(3)  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."Shop" (
"id" text  NOT NULL ,
"email" text  NOT NULL ,
"username" text  NOT NULL ,
"password" text  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."ShopItem" (
"id" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"name" text  NOT NULL ,
"description" text  NOT NULL ,
"price" Decimal(65,30)  NOT NULL ,
"imageUrl" text  NOT NULL ,
"shopId" text  NOT NULL ,
PRIMARY KEY ("id"))

CREATE TABLE "public"."Cart" (
"id" text  NOT NULL ,
"ownerId" text  NOT NULL ,
"chargeId" text   ,
"price" Decimal(65,30)  NOT NULL DEFAULT 0,
PRIMARY KEY ("id"))

CREATE TABLE "public"."CartItemCount" (
"id" text  NOT NULL ,
"cartId" text  NOT NULL ,
"itemId" text  NOT NULL ,
"price" Decimal(65,30)  NOT NULL ,
"count" integer  NOT NULL ,
PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "User.username" ON "public"."User"("username")

CREATE UNIQUE INDEX "Shop.email" ON "public"."Shop"("email")

CREATE UNIQUE INDEX "Shop.username" ON "public"."Shop"("username")

CREATE UNIQUE INDEX "Cart_ownerId" ON "public"."Cart"("ownerId")

ALTER TABLE "public"."ShopItem" ADD FOREIGN KEY ("shopId")REFERENCES "public"."Shop"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Cart" ADD FOREIGN KEY ("ownerId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."CartItemCount" ADD FOREIGN KEY ("cartId")REFERENCES "public"."Cart"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."CartItemCount" ADD FOREIGN KEY ("itemId")REFERENCES "public"."ShopItem"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200722005203-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,65 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider             = "prisma-client-js"
+  experimentalFeatures = ["aggregateApi"]
+}
+
+generator typegraphql {
+  provider = "node node_modules/typegraphql-prisma/generator.js"
+  output   = "../prisma/generated/type-graphql"
+}
+
+model User {
+  id       String   @default(uuid()) @id
+  email    String   @unique
+  username String   @unique
+  password String
+  dob      DateTime
+  cart     Cart?
+}
+
+model Shop {
+  id        String     @default(uuid()) @id
+  email     String     @unique
+  username  String     @unique
+  password  String
+  shopItems ShopItem[]
+}
+
+model ShopItem {
+  id            String          @default(uuid()) @id
+  createdAt     DateTime        @default(now())
+  name          String
+  description   String
+  price         Float
+  imageUrl      String
+  Shop          Shop            @relation(fields: [shopId], references: [id])
+  shopId        String
+  CartItemCount CartItemCount[]
+}
+
+model Cart {
+  id            String          @default(uuid()) @id
+  ownerId       String
+  owner         User            @relation(fields: [ownerId], references: [id])
+  chargeId      String?
+  price         Float           @default(0)
+  CartItemCount CartItemCount[]
+}
+
+model CartItemCount {
+  id       String   @default(uuid()) @id
+  cartId   String
+  cart     Cart     @relation(fields: [cartId], references: [id])
+  itemId   String
+  shopItem ShopItem @relation(fields: [itemId], references: [id])
+  price    Float
+  count    Int
+}
```


